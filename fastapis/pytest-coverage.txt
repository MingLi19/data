============================= test session starts ==============================
platform linux -- Python 3.13.1, pytest-8.3.4, pluggy-1.5.0
rootdir: /home/runner/work/data/data/fastapis
configfile: pyproject.toml
plugins: anyio-4.6.2.post1, cov-6.0.0
collected 24 items

tests/test_company_crud.py FFFFFFF                                       [ 29%]
tests/test_meta_r.py ...                                                 [ 41%]
tests/test_upload_cr.py ..                                               [ 50%]
tests/test_user_crud.py FFFFFF                                           [ 75%]
tests/test_vessel_crud.py ..F..F                                         [100%]

=================================== FAILURES ===================================
_____________________________ test_read_companies ______________________________

client = <starlette.testclient.TestClient object at 0x7fc0ff97c590>
setup = None

    def test_read_companies(client: TestClient, setup: None):
        response = client.get("/company/").json()
>       code = response["code"]
E       KeyError: 'code'

tests/test_company_crud.py:21: KeyError
---------------------------- Captured stdout setup -----------------------------
2025-02-06 14:40:05,633 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:05,633 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-02-06 14:40:05,634 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,634 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-02-06 14:40:05,634 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,635 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-02-06 14:40:05,635 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,635 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-02-06 14:40:05,635 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,635 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-02-06 14:40:05,635 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,636 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-02-06 14:40:05,636 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,636 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-02-06 14:40:05,636 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,636 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-02-06 14:40:05,636 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,637 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-02-06 14:40:05,637 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,637 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-02-06 14:40:05,637 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,637 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-02-06 14:40:05,637 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,638 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-02-06 14:40:05,638 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,638 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-02-06 14:40:05,638 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,638 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-02-06 14:40:05,638 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,639 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-02-06 14:40:05,639 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,639 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-02-06 14:40:05,639 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,639 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-02-06 14:40:05,639 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,640 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-02-06 14:40:05,640 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,640 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("power_speed_curve")
2025-02-06 14:40:05,640 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,640 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("power_speed_curve")
2025-02-06 14:40:05,640 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,644 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-02-06 14:40:05,644 INFO sqlalchemy.engine.Engine [no key 0.00016s] ()
2025-02-06 14:40:05,644 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,645 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:05,645 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,645 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:05,646 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,646 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,647 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-02-06 14:40:05,647 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,648 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-02-06 14:40:05,648 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,649 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,649 INFO sqlalchemy.engine.Engine [no key 0.00016s] ()
2025-02-06 14:40:05,650 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,650 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,650 INFO sqlalchemy.engine.Engine 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,650 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,651 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-02-06 14:40:05,651 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,651 INFO sqlalchemy.engine.Engine COMMIT
2025-02-06 14:40:05,681 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:05,684 INFO sqlalchemy.engine.Engine INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:05,684 INFO sqlalchemy.engine.Engine [generated in 0.00043s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:05.680073')
2025-02-06 14:40:05,685 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00016s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00016s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00043s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:05.680073')
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
______________________________ test_read_company _______________________________

client = <starlette.testclient.TestClient object at 0x7fc0ff98ccd0>
setup = None

    def test_read_company(client: TestClient, setup: None):
        response = client.get("/company/1").json()
>       code = response["code"]
E       KeyError: 'code'

tests/test_company_crud.py:29: KeyError
---------------------------- Captured stdout setup -----------------------------
2025-02-06 14:40:05,836 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:05,837 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-02-06 14:40:05,837 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,837 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-02-06 14:40:05,837 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,838 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-02-06 14:40:05,838 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,838 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-02-06 14:40:05,838 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,838 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-02-06 14:40:05,838 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,839 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-02-06 14:40:05,839 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,839 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-02-06 14:40:05,839 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,839 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-02-06 14:40:05,839 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,840 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-02-06 14:40:05,840 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,840 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-02-06 14:40:05,840 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,840 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-02-06 14:40:05,840 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,841 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-02-06 14:40:05,841 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,841 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-02-06 14:40:05,841 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,841 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-02-06 14:40:05,841 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,842 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-02-06 14:40:05,842 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,842 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-02-06 14:40:05,842 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,842 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-02-06 14:40:05,842 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,843 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-02-06 14:40:05,843 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,843 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("power_speed_curve")
2025-02-06 14:40:05,843 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,843 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("power_speed_curve")
2025-02-06 14:40:05,843 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,844 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-02-06 14:40:05,845 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,845 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,845 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,846 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,846 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,846 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,846 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,847 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-02-06 14:40:05,847 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,848 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-02-06 14:40:05,848 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,849 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,849 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,849 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,849 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,850 INFO sqlalchemy.engine.Engine 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,850 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,850 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-02-06 14:40:05,851 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,851 INFO sqlalchemy.engine.Engine COMMIT
2025-02-06 14:40:05,852 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:05,854 INFO sqlalchemy.engine.Engine INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:05,854 INFO sqlalchemy.engine.Engine [generated in 0.00029s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:05.852189')
2025-02-06 14:40:05,854 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00029s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:05.852189')
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
_________________________ test_read_company_not_found __________________________

client = <starlette.testclient.TestClient object at 0x7fc0fe435450>

    def test_read_company_not_found(client: TestClient):
        response = client.get("/company/2")
        assert response.status_code == 404
>       assert response.json()["message"] == "公司不存在"
E       KeyError: 'message'

tests/test_company_crud.py:38: KeyError
---------------------------- Captured stdout setup -----------------------------
2025-02-06 14:40:05,864 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:05,865 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-02-06 14:40:05,865 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,865 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-02-06 14:40:05,865 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,865 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-02-06 14:40:05,865 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,866 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-02-06 14:40:05,866 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,866 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-02-06 14:40:05,866 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,866 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-02-06 14:40:05,867 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,867 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-02-06 14:40:05,867 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,867 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-02-06 14:40:05,867 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,867 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-02-06 14:40:05,868 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,868 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-02-06 14:40:05,868 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,868 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-02-06 14:40:05,868 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,868 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-02-06 14:40:05,869 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,869 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-02-06 14:40:05,869 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,869 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-02-06 14:40:05,869 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,870 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-02-06 14:40:05,870 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,870 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-02-06 14:40:05,870 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,870 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-02-06 14:40:05,870 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,871 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-02-06 14:40:05,871 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,871 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("power_speed_curve")
2025-02-06 14:40:05,871 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,871 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("power_speed_curve")
2025-02-06 14:40:05,871 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,872 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-02-06 14:40:05,872 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,873 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,873 INFO sqlalchemy.engine.Engine [no key 0.00018s] ()
2025-02-06 14:40:05,873 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,874 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,874 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,874 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,875 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-02-06 14:40:05,875 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:05,876 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-02-06 14:40:05,876 INFO sqlalchemy.engine.Engine [no key 0.00016s] ()
2025-02-06 14:40:05,877 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,877 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,877 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,877 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,878 INFO sqlalchemy.engine.Engine 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,878 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:05,878 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-02-06 14:40:05,878 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,879 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00018s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00016s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
_____________________________ test_create_company ______________________________

client = <starlette.testclient.TestClient object at 0x7fc0fe4ed940>

    def test_create_company(client: TestClient):
        response = client.post(
            "/company/",
            json={
                "name": "Company A",
            },
        ).json()
>       code = response["code"]
E       KeyError: 'code'

tests/test_company_crud.py:48: KeyError
---------------------------- Captured stdout setup -----------------------------
2025-02-06 14:40:05,890 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:05,890 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-02-06 14:40:05,890 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,890 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-02-06 14:40:05,891 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,891 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-02-06 14:40:05,891 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,891 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-02-06 14:40:05,891 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,891 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-02-06 14:40:05,892 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,892 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-02-06 14:40:05,892 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,892 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-02-06 14:40:05,892 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,893 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-02-06 14:40:05,893 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,893 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-02-06 14:40:05,893 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,893 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-02-06 14:40:05,893 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,894 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-02-06 14:40:05,894 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,894 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-02-06 14:40:05,894 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,894 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-02-06 14:40:05,894 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,895 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-02-06 14:40:05,895 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,895 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-02-06 14:40:05,895 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,895 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-02-06 14:40:05,895 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,896 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-02-06 14:40:05,896 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,896 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-02-06 14:40:05,896 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,896 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("power_speed_curve")
2025-02-06 14:40:05,896 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,897 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("power_speed_curve")
2025-02-06 14:40:05,897 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,898 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-02-06 14:40:05,898 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,898 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,898 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,899 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,899 INFO sqlalchemy.engine.Engine [no key 0.00016s] ()
2025-02-06 14:40:05,899 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,899 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,900 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-02-06 14:40:05,900 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,901 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-02-06 14:40:05,901 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,902 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,902 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:05,902 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,903 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,903 INFO sqlalchemy.engine.Engine 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,903 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,903 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-02-06 14:40:05,904 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,904 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00016s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
________________________ test_create_company_duplicate _________________________

client = <starlette.testclient.TestClient object at 0x7fc0fe4ef5c0>
setup = None

    def test_create_company_duplicate(client: TestClient, setup: None):
        response = client.post(
            "/company/",
            json={
                "name": "Company Test",
            },
        ).json()
>       code = response["code"]
E       KeyError: 'code'

tests/test_company_crud.py:61: KeyError
---------------------------- Captured stdout setup -----------------------------
2025-02-06 14:40:05,914 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:05,915 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-02-06 14:40:05,915 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,915 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-02-06 14:40:05,915 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,915 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-02-06 14:40:05,916 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,916 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-02-06 14:40:05,916 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,916 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-02-06 14:40:05,916 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,917 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-02-06 14:40:05,917 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,917 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-02-06 14:40:05,917 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,917 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-02-06 14:40:05,917 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,918 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-02-06 14:40:05,918 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,918 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-02-06 14:40:05,918 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,918 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-02-06 14:40:05,918 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,919 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-02-06 14:40:05,919 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,919 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-02-06 14:40:05,919 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,919 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-02-06 14:40:05,919 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,920 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-02-06 14:40:05,920 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,920 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-02-06 14:40:05,920 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,920 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-02-06 14:40:05,920 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,921 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-02-06 14:40:05,921 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,921 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("power_speed_curve")
2025-02-06 14:40:05,921 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,921 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("power_speed_curve")
2025-02-06 14:40:05,921 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,922 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-02-06 14:40:05,922 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,923 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,923 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,924 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,924 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,924 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,924 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,925 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-02-06 14:40:05,925 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,926 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-02-06 14:40:05,926 INFO sqlalchemy.engine.Engine [no key 0.00016s] ()
2025-02-06 14:40:05,927 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,927 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,927 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,927 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,928 INFO sqlalchemy.engine.Engine 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,928 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:05,928 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-02-06 14:40:05,928 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,929 INFO sqlalchemy.engine.Engine COMMIT
2025-02-06 14:40:05,930 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:05,931 INFO sqlalchemy.engine.Engine INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:05,931 INFO sqlalchemy.engine.Engine [generated in 0.00028s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:05.929964')
2025-02-06 14:40:05,932 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00016s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00028s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:05.929964')
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
_____________________________ test_update_company ______________________________

client = <starlette.testclient.TestClient object at 0x7fc0fe455370>
setup = None

    def test_update_company(client: TestClient, setup: None):
        response = client.put(
            "/company/1",
            json={
                "name": "Company B",
            },
        ).json()
        print(response)
>       code = response["code"]
E       KeyError: 'code'

tests/test_company_crud.py:73: KeyError
---------------------------- Captured stdout setup -----------------------------
2025-02-06 14:40:05,942 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:05,942 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-02-06 14:40:05,942 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,943 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-02-06 14:40:05,943 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,943 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-02-06 14:40:05,943 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,943 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-02-06 14:40:05,943 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,944 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-02-06 14:40:05,944 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,944 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-02-06 14:40:05,944 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,944 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-02-06 14:40:05,944 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,945 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-02-06 14:40:05,945 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,945 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-02-06 14:40:05,945 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,945 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-02-06 14:40:05,945 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,946 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-02-06 14:40:05,946 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,946 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-02-06 14:40:05,946 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,946 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-02-06 14:40:05,946 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,947 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-02-06 14:40:05,947 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,947 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-02-06 14:40:05,947 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,947 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-02-06 14:40:05,947 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,948 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-02-06 14:40:05,948 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,948 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-02-06 14:40:05,948 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,948 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("power_speed_curve")
2025-02-06 14:40:05,948 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,949 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("power_speed_curve")
2025-02-06 14:40:05,949 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,950 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-02-06 14:40:05,950 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,950 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,950 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,951 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,951 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:05,951 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,952 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,952 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-02-06 14:40:05,952 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,953 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-02-06 14:40:05,953 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,954 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,954 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,955 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,955 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,955 INFO sqlalchemy.engine.Engine 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,955 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,956 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-02-06 14:40:05,956 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,956 INFO sqlalchemy.engine.Engine COMMIT
2025-02-06 14:40:05,957 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:05,959 INFO sqlalchemy.engine.Engine INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:05,959 INFO sqlalchemy.engine.Engine [generated in 0.00027s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:05.957359')
2025-02-06 14:40:05,959 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00027s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:05.957359')
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
----------------------------- Captured stdout call -----------------------------
{'detail': 'Not Found'}
_____________________________ test_delete_company ______________________________

client = <starlette.testclient.TestClient object at 0x7fc0fe306470>
setup = None

    def test_delete_company(client: TestClient, setup: None):
        response = client.delete("/company/1").json()
>       code = response["code"]
E       KeyError: 'code'

tests/test_company_crud.py:81: KeyError
---------------------------- Captured stdout setup -----------------------------
2025-02-06 14:40:05,970 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:05,970 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-02-06 14:40:05,970 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,970 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-02-06 14:40:05,970 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,971 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-02-06 14:40:05,971 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,971 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-02-06 14:40:05,971 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,971 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-02-06 14:40:05,972 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,972 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-02-06 14:40:05,972 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,972 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-02-06 14:40:05,972 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,972 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-02-06 14:40:05,973 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,973 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-02-06 14:40:05,973 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,973 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-02-06 14:40:05,973 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,974 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-02-06 14:40:05,974 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,974 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-02-06 14:40:05,974 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,974 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-02-06 14:40:05,974 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,975 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-02-06 14:40:05,975 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,975 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-02-06 14:40:05,975 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,975 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-02-06 14:40:05,975 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,976 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-02-06 14:40:05,976 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,976 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-02-06 14:40:05,976 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,976 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("power_speed_curve")
2025-02-06 14:40:05,976 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,977 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("power_speed_curve")
2025-02-06 14:40:05,977 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:05,978 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-02-06 14:40:05,978 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,978 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,978 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,979 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,979 INFO sqlalchemy.engine.Engine [no key 0.00016s] ()
2025-02-06 14:40:05,979 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:05,979 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,980 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-02-06 14:40:05,980 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,981 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-02-06 14:40:05,981 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,982 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,982 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:05,982 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,983 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,983 INFO sqlalchemy.engine.Engine 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:05,983 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:05,984 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-02-06 14:40:05,984 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:05,984 INFO sqlalchemy.engine.Engine COMMIT
2025-02-06 14:40:05,985 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:05,986 INFO sqlalchemy.engine.Engine INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:05,987 INFO sqlalchemy.engine.Engine [generated in 0.00028s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:05.985159')
2025-02-06 14:40:05,987 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00016s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00028s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:05.985159')
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
_______________________________ test_read_users ________________________________

client = <starlette.testclient.TestClient object at 0x7fc0ff9f67b0>
setup = None

    def test_read_users(client, setup):
        response = client.get("/user/").json()
>       code = response["code"]
E       KeyError: 'code'

tests/test_user_crud.py:25: KeyError
---------------------------- Captured stdout setup -----------------------------
2025-02-06 14:40:06,182 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:06,182 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-02-06 14:40:06,182 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,183 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-02-06 14:40:06,183 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,183 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-02-06 14:40:06,183 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,183 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-02-06 14:40:06,184 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,184 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-02-06 14:40:06,184 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,184 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-02-06 14:40:06,184 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,184 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-02-06 14:40:06,185 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,185 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-02-06 14:40:06,185 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,185 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-02-06 14:40:06,185 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,186 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-02-06 14:40:06,186 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,186 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-02-06 14:40:06,186 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,186 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-02-06 14:40:06,186 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,187 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-02-06 14:40:06,187 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,187 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-02-06 14:40:06,187 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,187 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-02-06 14:40:06,187 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,188 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-02-06 14:40:06,188 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,188 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-02-06 14:40:06,188 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,188 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-02-06 14:40:06,188 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,189 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("power_speed_curve")
2025-02-06 14:40:06,189 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,189 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("power_speed_curve")
2025-02-06 14:40:06,189 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,190 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-02-06 14:40:06,190 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:06,191 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,191 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:06,191 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,192 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,192 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,192 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,193 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-02-06 14:40:06,193 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:06,194 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-02-06 14:40:06,194 INFO sqlalchemy.engine.Engine [no key 0.00016s] ()
2025-02-06 14:40:06,194 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,195 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:06,195 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,195 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,196 INFO sqlalchemy.engine.Engine 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,196 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:06,196 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-02-06 14:40:06,196 INFO sqlalchemy.engine.Engine [no key 0.00021s] ()
2025-02-06 14:40:06,197 INFO sqlalchemy.engine.Engine COMMIT
2025-02-06 14:40:06,199 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:06,200 INFO sqlalchemy.engine.Engine INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:06,200 INFO sqlalchemy.engine.Engine [generated in 0.00028s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:06.198003')
2025-02-06 14:40:06,202 INFO sqlalchemy.engine.Engine INSERT INTO user (id, name, username, hashed_password, phone, is_admin, is_system_admin, disabled, created_at, company_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:06,203 INFO sqlalchemy.engine.Engine [generated in 0.00030s] (1, 'User Test', 'user_test', '123456', '12345678999', 0, 0, 0, '2025-02-06 14:40:06.198206', 1)
2025-02-06 14:40:06,203 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00016s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00021s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00028s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:06.198003')
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO user (id, name, username, hashed_password, phone, is_admin, is_system_admin, disabled, created_at, company_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00030s] (1, 'User Test', 'user_test', '123456', '12345678999', 0, 0, 0, '2025-02-06 14:40:06.198206', 1)
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
________________________________ test_read_user ________________________________

client = <starlette.testclient.TestClient object at 0x7fc0fe366b30>
setup = None

    def test_read_user(client, setup):
        response = client.get("/user/1").json()
        print("response: ", response)
    
>       code = response["code"]
E       KeyError: 'code'

tests/test_user_crud.py:35: KeyError
---------------------------- Captured stdout setup -----------------------------
2025-02-06 14:40:06,213 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:06,213 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-02-06 14:40:06,214 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,214 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-02-06 14:40:06,214 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,214 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-02-06 14:40:06,214 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,215 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-02-06 14:40:06,215 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,215 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-02-06 14:40:06,215 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,215 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-02-06 14:40:06,215 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,216 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-02-06 14:40:06,216 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,216 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-02-06 14:40:06,216 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,216 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-02-06 14:40:06,216 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,217 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-02-06 14:40:06,217 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,217 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-02-06 14:40:06,217 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,217 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-02-06 14:40:06,218 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,218 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-02-06 14:40:06,218 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,218 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-02-06 14:40:06,218 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,218 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-02-06 14:40:06,219 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,219 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-02-06 14:40:06,219 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,219 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-02-06 14:40:06,219 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,220 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-02-06 14:40:06,220 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,220 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("power_speed_curve")
2025-02-06 14:40:06,220 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,220 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("power_speed_curve")
2025-02-06 14:40:06,220 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,221 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-02-06 14:40:06,221 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,222 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,222 INFO sqlalchemy.engine.Engine [no key 0.00016s] ()
2025-02-06 14:40:06,222 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,223 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,223 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,223 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:06,224 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-02-06 14:40:06,224 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,225 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-02-06 14:40:06,225 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,226 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,226 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,226 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,226 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,227 INFO sqlalchemy.engine.Engine 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,227 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:06,227 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-02-06 14:40:06,228 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:06,228 INFO sqlalchemy.engine.Engine COMMIT
2025-02-06 14:40:06,230 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:06,231 INFO sqlalchemy.engine.Engine INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:06,231 INFO sqlalchemy.engine.Engine [generated in 0.00030s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:06.229121')
2025-02-06 14:40:06,233 INFO sqlalchemy.engine.Engine INSERT INTO user (id, name, username, hashed_password, phone, is_admin, is_system_admin, disabled, created_at, company_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:06,233 INFO sqlalchemy.engine.Engine [generated in 0.00029s] (1, 'User Test', 'user_test', '123456', '12345678999', 0, 0, 0, '2025-02-06 14:40:06.229312', 1)
2025-02-06 14:40:06,233 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00016s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00030s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:06.229121')
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO user (id, name, username, hashed_password, phone, is_admin, is_system_admin, disabled, created_at, company_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00029s] (1, 'User Test', 'user_test', '123456', '12345678999', 0, 0, 0, '2025-02-06 14:40:06.229312', 1)
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
----------------------------- Captured stdout call -----------------------------
response:  {'detail': 'Not Found'}
___________________________ test_read_user_not_found ___________________________

client = <starlette.testclient.TestClient object at 0x7fc0fe3c3070>

    def test_read_user_not_found(client):
        response = client.get("/user/2")
        assert response.status_code == 404
>       assert response.json()["detail"] == "用户不存在"
E       AssertionError: assert 'Not Found' == '用户不存在'
E         
E         - 用户不存在
E         + Not Found

tests/test_user_crud.py:44: AssertionError
---------------------------- Captured stdout setup -----------------------------
2025-02-06 14:40:06,244 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:06,244 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-02-06 14:40:06,244 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,244 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-02-06 14:40:06,244 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,245 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-02-06 14:40:06,245 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,245 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-02-06 14:40:06,245 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,245 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-02-06 14:40:06,245 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,246 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-02-06 14:40:06,246 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,246 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-02-06 14:40:06,246 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,246 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-02-06 14:40:06,246 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,247 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-02-06 14:40:06,247 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,247 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-02-06 14:40:06,247 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,247 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-02-06 14:40:06,247 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,248 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-02-06 14:40:06,248 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,248 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-02-06 14:40:06,248 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,248 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-02-06 14:40:06,248 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,249 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-02-06 14:40:06,249 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,249 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-02-06 14:40:06,249 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,249 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-02-06 14:40:06,249 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,250 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-02-06 14:40:06,250 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,250 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("power_speed_curve")
2025-02-06 14:40:06,250 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,250 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("power_speed_curve")
2025-02-06 14:40:06,250 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,251 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-02-06 14:40:06,251 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:06,252 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,252 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,253 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,253 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,253 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,253 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,254 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-02-06 14:40:06,254 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,255 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-02-06 14:40:06,255 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,256 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,256 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,256 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,256 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:06,257 INFO sqlalchemy.engine.Engine 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,257 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,257 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-02-06 14:40:06,258 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,258 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
_______________________________ test_create_user _______________________________

client = <starlette.testclient.TestClient object at 0x7fc0fe366eb0>
setup = None

    def test_create_user(client, setup):
        response = client.post(
            "/user/",
            json={
                "name": "User A",
                "username": "user_a",
                "hashed_password": "123456",
                "phone": "12345678999",
                "company_id": 1,
            },
        ).json()
>       code = response["code"]
E       KeyError: 'code'

tests/test_user_crud.py:58: KeyError
---------------------------- Captured stdout setup -----------------------------
2025-02-06 14:40:06,273 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:06,273 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-02-06 14:40:06,273 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,273 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-02-06 14:40:06,273 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,274 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-02-06 14:40:06,274 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,274 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-02-06 14:40:06,274 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,274 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-02-06 14:40:06,275 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,275 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-02-06 14:40:06,275 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,275 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-02-06 14:40:06,275 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,275 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-02-06 14:40:06,276 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,276 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-02-06 14:40:06,276 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,276 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-02-06 14:40:06,276 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,276 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-02-06 14:40:06,277 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,277 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-02-06 14:40:06,277 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,277 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-02-06 14:40:06,277 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,277 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-02-06 14:40:06,278 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,278 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-02-06 14:40:06,278 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,278 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-02-06 14:40:06,278 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,279 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-02-06 14:40:06,279 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,279 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-02-06 14:40:06,279 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,279 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("power_speed_curve")
2025-02-06 14:40:06,279 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,280 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("power_speed_curve")
2025-02-06 14:40:06,280 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,280 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-02-06 14:40:06,281 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,281 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,281 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,282 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,282 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,282 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,282 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:06,283 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-02-06 14:40:06,283 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,284 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-02-06 14:40:06,284 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,285 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,285 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:06,285 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,285 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:06,286 INFO sqlalchemy.engine.Engine 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,286 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,286 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-02-06 14:40:06,287 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:06,287 INFO sqlalchemy.engine.Engine COMMIT
2025-02-06 14:40:06,289 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:06,290 INFO sqlalchemy.engine.Engine INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:06,290 INFO sqlalchemy.engine.Engine [generated in 0.00030s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:06.288063')
2025-02-06 14:40:06,292 INFO sqlalchemy.engine.Engine INSERT INTO user (id, name, username, hashed_password, phone, is_admin, is_system_admin, disabled, created_at, company_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:06,292 INFO sqlalchemy.engine.Engine [generated in 0.00029s] (1, 'User Test', 'user_test', '123456', '12345678999', 0, 0, 0, '2025-02-06 14:40:06.288248', 1)
2025-02-06 14:40:06,292 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00030s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:06.288063')
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO user (id, name, username, hashed_password, phone, is_admin, is_system_admin, disabled, created_at, company_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00029s] (1, 'User Test', 'user_test', '123456', '12345678999', 0, 0, 0, '2025-02-06 14:40:06.288248', 1)
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
_______________________________ test_update_user _______________________________

client = <starlette.testclient.TestClient object at 0x7fc0fe339a90>
setup = None

    def test_update_user(client, setup):
        response = client.put(
            "/user/1",
            json={
                "name": "User B",
                "username": "user_b",
                "hashed_password": "123456",
                "phone": "12345678999",
                "company_id": 1,
            },
        ).json()
        print(response)
>       code = response["code"]
E       KeyError: 'code'

tests/test_user_crud.py:76: KeyError
---------------------------- Captured stdout setup -----------------------------
2025-02-06 14:40:06,302 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:06,303 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-02-06 14:40:06,303 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,303 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-02-06 14:40:06,303 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,303 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-02-06 14:40:06,304 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,304 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-02-06 14:40:06,304 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,304 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-02-06 14:40:06,304 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,304 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-02-06 14:40:06,305 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,305 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-02-06 14:40:06,305 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,305 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-02-06 14:40:06,305 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,306 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-02-06 14:40:06,306 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,306 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-02-06 14:40:06,306 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,306 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-02-06 14:40:06,306 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,307 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-02-06 14:40:06,307 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,307 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-02-06 14:40:06,307 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,307 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-02-06 14:40:06,307 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,308 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-02-06 14:40:06,308 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,308 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-02-06 14:40:06,308 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,308 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-02-06 14:40:06,308 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,309 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-02-06 14:40:06,309 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,309 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("power_speed_curve")
2025-02-06 14:40:06,309 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,309 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("power_speed_curve")
2025-02-06 14:40:06,309 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,310 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-02-06 14:40:06,310 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:06,311 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,311 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,312 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,312 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,312 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,312 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,313 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-02-06 14:40:06,313 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,314 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-02-06 14:40:06,314 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,315 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,315 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:06,315 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,315 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:06,316 INFO sqlalchemy.engine.Engine 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,316 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,316 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-02-06 14:40:06,317 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,317 INFO sqlalchemy.engine.Engine COMMIT
2025-02-06 14:40:06,319 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:06,320 INFO sqlalchemy.engine.Engine INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:06,320 INFO sqlalchemy.engine.Engine [generated in 0.00031s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:06.318142')
2025-02-06 14:40:06,322 INFO sqlalchemy.engine.Engine INSERT INTO user (id, name, username, hashed_password, phone, is_admin, is_system_admin, disabled, created_at, company_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:06,322 INFO sqlalchemy.engine.Engine [generated in 0.00030s] (1, 'User Test', 'user_test', '123456', '12345678999', 0, 0, 0, '2025-02-06 14:40:06.318327', 1)
2025-02-06 14:40:06,322 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00031s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:06.318142')
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO user (id, name, username, hashed_password, phone, is_admin, is_system_admin, disabled, created_at, company_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00030s] (1, 'User Test', 'user_test', '123456', '12345678999', 0, 0, 0, '2025-02-06 14:40:06.318327', 1)
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
----------------------------- Captured stdout call -----------------------------
{'detail': 'Not Found'}
_______________________________ test_delete_user _______________________________

client = <starlette.testclient.TestClient object at 0x7fc0fe43c2f0>
setup = None

    def test_delete_user(client, setup):
        response = client.delete("/user/1").json()
>       code = response["code"]
E       KeyError: 'code'

tests/test_user_crud.py:84: KeyError
---------------------------- Captured stdout setup -----------------------------
2025-02-06 14:40:06,333 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:06,333 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-02-06 14:40:06,334 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,334 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-02-06 14:40:06,334 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,334 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-02-06 14:40:06,334 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,335 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-02-06 14:40:06,335 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,335 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-02-06 14:40:06,335 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,335 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-02-06 14:40:06,335 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,336 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-02-06 14:40:06,336 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,336 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-02-06 14:40:06,336 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,336 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-02-06 14:40:06,336 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,337 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-02-06 14:40:06,337 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,337 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-02-06 14:40:06,337 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,337 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-02-06 14:40:06,338 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,338 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-02-06 14:40:06,338 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,338 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-02-06 14:40:06,338 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,338 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-02-06 14:40:06,339 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,339 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-02-06 14:40:06,339 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,339 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-02-06 14:40:06,339 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,339 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-02-06 14:40:06,340 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,340 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("power_speed_curve")
2025-02-06 14:40:06,340 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,340 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("power_speed_curve")
2025-02-06 14:40:06,340 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,341 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-02-06 14:40:06,341 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,342 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,342 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,342 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,343 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,343 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,343 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,344 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-02-06 14:40:06,344 INFO sqlalchemy.engine.Engine [no key 0.00016s] ()
2025-02-06 14:40:06,345 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-02-06 14:40:06,345 INFO sqlalchemy.engine.Engine [no key 0.00016s] ()
2025-02-06 14:40:06,345 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,346 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:06,346 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,346 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,347 INFO sqlalchemy.engine.Engine 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,347 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:06,347 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-02-06 14:40:06,347 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:06,348 INFO sqlalchemy.engine.Engine COMMIT
2025-02-06 14:40:06,349 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:06,351 INFO sqlalchemy.engine.Engine INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:06,351 INFO sqlalchemy.engine.Engine [generated in 0.00027s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:06.348883')
2025-02-06 14:40:06,352 INFO sqlalchemy.engine.Engine INSERT INTO user (id, name, username, hashed_password, phone, is_admin, is_system_admin, disabled, created_at, company_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:06,352 INFO sqlalchemy.engine.Engine [generated in 0.00028s] (1, 'User Test', 'user_test', '123456', '12345678999', 0, 0, 0, '2025-02-06 14:40:06.349069', 1)
2025-02-06 14:40:06,353 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00016s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00016s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00027s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:06.348883')
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO user (id, name, username, hashed_password, phone, is_admin, is_system_admin, disabled, created_at, company_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00028s] (1, 'User Test', 'user_test', '123456', '12345678999', 0, 0, 0, '2025-02-06 14:40:06.349069', 1)
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
__________________________ test_read_vessel_not_found __________________________

client = <starlette.testclient.TestClient object at 0x7fc0fe3c3cb0>

    def test_read_vessel_not_found(client: TestClient):
>       response = client.get("/vessel/2")

tests/test_vessel_crud.py:70: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/testclient.py:514: in get
    return super().get(
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/httpx/_client.py:1066: in get
    return self.request(
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/testclient.py:484: in request
    return super().request(
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/httpx/_client.py:837: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/httpx/_client.py:926: in send
    response = self._send_handling_auth(
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/httpx/_client.py:954: in _send_handling_auth
    response = self._send_handling_redirects(
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/httpx/_client.py:991: in _send_handling_redirects
    response = self._send_single_request(request)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/httpx/_client.py:1027: in _send_single_request
    response = transport.handle_request(request)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/testclient.py:377: in handle_request
    raise exc
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/testclient.py:374: in handle_request
    portal.call(self.app, scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/concurrent/futures/_base.py:456: in result
    return self.__get_result()
/opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/routing.py:715: in __call__
    await self.middleware_stack(scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/routing.py:735: in app
    await route.handle(scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/fastapi/routing.py:301: in app
    raw_response = await run_endpoint_function(
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/fastapi/routing.py:212: in run_endpoint_function
    return await dependant.call(**values)
app/router/vessel.py:43: in get_vessel
    vessel = service.get_vessel_by_id(vessel_id)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <app.service.vessel.VesselService object at 0x7fc0fe446c40>
vessel_id = 2

    def get_vessel_by_id(self, vessel_id: int) -> Vessel:
        vessel = self.session.get(Vessel, vessel_id)
        if not vessel:
>           raise NotFoundException(detail="船舶不存在")
E           app.core.error.NotFoundException

app/service/vessel.py:29: NotFoundException
---------------------------- Captured stdout setup -----------------------------
2025-02-06 14:40:06,440 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:06,440 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-02-06 14:40:06,440 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,440 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-02-06 14:40:06,441 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,441 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-02-06 14:40:06,441 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,441 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-02-06 14:40:06,441 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,442 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-02-06 14:40:06,442 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,442 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-02-06 14:40:06,442 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,442 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-02-06 14:40:06,442 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,443 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-02-06 14:40:06,443 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,443 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-02-06 14:40:06,443 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,443 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-02-06 14:40:06,443 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,444 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-02-06 14:40:06,444 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,444 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-02-06 14:40:06,444 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,444 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-02-06 14:40:06,445 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,445 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-02-06 14:40:06,445 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,445 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-02-06 14:40:06,445 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,445 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-02-06 14:40:06,446 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,446 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-02-06 14:40:06,446 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,446 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-02-06 14:40:06,446 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,447 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("power_speed_curve")
2025-02-06 14:40:06,447 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,447 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("power_speed_curve")
2025-02-06 14:40:06,447 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:06,448 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-02-06 14:40:06,448 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:06,449 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,449 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,449 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,449 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:06,450 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:06,450 INFO sqlalchemy.engine.Engine [no key 0.00016s] ()
2025-02-06 14:40:06,451 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-02-06 14:40:06,451 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,452 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-02-06 14:40:06,452 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,452 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,452 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,453 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,453 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,454 INFO sqlalchemy.engine.Engine 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:06,454 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:06,454 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-02-06 14:40:06,454 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:06,455 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00016s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
----------------------------- Captured stdout call -----------------------------
2025-02-06 14:40:06,459 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:06,461 INFO sqlalchemy.engine.Engine SELECT vessel.id AS vessel_id, vessel.name AS vessel_name, vessel.mmsi AS vessel_mmsi, vessel.build_date AS vessel_build_date, vessel.gross_tone AS vessel_gross_tone, vessel.dead_weight AS vessel_dead_weight, vessel.new_vessel AS vessel_new_vessel, vessel.hull_clean_date AS vessel_hull_clean_date, vessel.engine_overhaul_date AS vessel_engine_overhaul_date, vessel.newly_paint_date AS vessel_newly_paint_date, vessel.propeller_polish_date AS vessel_propeller_polish_date, vessel.created_at AS vessel_created_at, vessel.company_id AS vessel_company_id, vessel.ship_type_id AS vessel_ship_type_id, vessel.time_zone_id AS vessel_time_zone_id 
FROM vessel 
WHERE vessel.id = ?
2025-02-06 14:40:06,461 INFO sqlalchemy.engine.Engine [generated in 0.00023s] (2,)
------------------------------ Captured log call -------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT vessel.id AS vessel_id, vessel.name AS vessel_name, vessel.mmsi AS vessel_mmsi, vessel.build_date AS vessel_build_date, vessel.gross_tone AS vessel_gross_tone, vessel.dead_weight AS vessel_dead_weight, vessel.new_vessel AS vessel_new_vessel, vessel.hull_clean_date AS vessel_hull_clean_date, vessel.engine_overhaul_date AS vessel_engine_overhaul_date, vessel.newly_paint_date AS vessel_newly_paint_date, vessel.propeller_polish_date AS vessel_propeller_polish_date, vessel.created_at AS vessel_created_at, vessel.company_id AS vessel_company_id, vessel.ship_type_id AS vessel_ship_type_id, vessel.time_zone_id AS vessel_time_zone_id 
FROM vessel 
WHERE vessel.id = ?
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00023s] (2,)
--------------------------- Captured stdout teardown ---------------------------
2025-02-06 14:40:07,053 INFO sqlalchemy.engine.Engine ROLLBACK
---------------------------- Captured log teardown -----------------------------
INFO     sqlalchemy.engine.Engine:base.py:2704 ROLLBACK
______________________________ test_delete_vessel ______________________________

client = <starlette.testclient.TestClient object at 0x7fc0fe77bbd0>
setup = None

    def test_delete_vessel(client: TestClient, setup):
        response = client.delete("/vessel/1").json()
        code = response["code"]
        message = response["message"]
        assert code == 200
        assert message == "船舶删除成功"
    
>       not_found_response = client.get("/vessel/1")

tests/test_vessel_crud.py:168: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/testclient.py:514: in get
    return super().get(
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/httpx/_client.py:1066: in get
    return self.request(
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/testclient.py:484: in request
    return super().request(
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/httpx/_client.py:837: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/httpx/_client.py:926: in send
    response = self._send_handling_auth(
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/httpx/_client.py:954: in _send_handling_auth
    response = self._send_handling_redirects(
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/httpx/_client.py:991: in _send_handling_redirects
    response = self._send_single_request(request)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/httpx/_client.py:1027: in _send_single_request
    response = transport.handle_request(request)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/testclient.py:377: in handle_request
    raise exc
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/testclient.py:374: in handle_request
    portal.call(self.app, scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/concurrent/futures/_base.py:456: in result
    return self.__get_result()
/opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/routing.py:715: in __call__
    await self.middleware_stack(scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/routing.py:735: in app
    await route.handle(scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/fastapi/routing.py:301: in app
    raw_response = await run_endpoint_function(
../../../../.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/fastapi/routing.py:212: in run_endpoint_function
    return await dependant.call(**values)
app/router/vessel.py:43: in get_vessel
    vessel = service.get_vessel_by_id(vessel_id)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <app.service.vessel.VesselService object at 0x7fc0fe452be0>
vessel_id = 1

    def get_vessel_by_id(self, vessel_id: int) -> Vessel:
        vessel = self.session.get(Vessel, vessel_id)
        if not vessel:
>           raise NotFoundException(detail="船舶不存在")
E           app.core.error.NotFoundException

app/service/vessel.py:29: NotFoundException
---------------------------- Captured stdout setup -----------------------------
2025-02-06 14:40:07,177 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:07,177 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-02-06 14:40:07,177 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,177 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-02-06 14:40:07,177 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,178 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-02-06 14:40:07,178 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,178 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-02-06 14:40:07,178 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,178 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-02-06 14:40:07,178 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,179 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-02-06 14:40:07,179 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,179 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-02-06 14:40:07,179 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,179 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-02-06 14:40:07,180 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,180 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-02-06 14:40:07,180 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,180 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-02-06 14:40:07,180 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,180 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-02-06 14:40:07,181 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,181 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-02-06 14:40:07,181 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,181 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-02-06 14:40:07,181 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,181 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-02-06 14:40:07,182 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,182 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-02-06 14:40:07,182 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,182 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-02-06 14:40:07,182 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,183 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-02-06 14:40:07,183 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,183 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-02-06 14:40:07,183 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,183 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("power_speed_curve")
2025-02-06 14:40:07,183 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,184 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("power_speed_curve")
2025-02-06 14:40:07,184 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-02-06 14:40:07,185 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-02-06 14:40:07,185 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:07,185 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:07,186 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:07,186 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:07,186 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:07,187 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-02-06 14:40:07,187 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:07,187 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-02-06 14:40:07,188 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:07,188 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-02-06 14:40:07,189 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:07,189 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:07,189 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:07,190 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:07,190 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-02-06 14:40:07,190 INFO sqlalchemy.engine.Engine 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-02-06 14:40:07,190 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-02-06 14:40:07,191 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-02-06 14:40:07,191 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-02-06 14:40:07,191 INFO sqlalchemy.engine.Engine COMMIT
2025-02-06 14:40:07,194 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:07,195 INFO sqlalchemy.engine.Engine INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:07,195 INFO sqlalchemy.engine.Engine [generated in 0.00029s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:07.192638')
2025-02-06 14:40:07,196 INFO sqlalchemy.engine.Engine INSERT INTO ship_type (id, name_cn, name_en, code) VALUES (?, ?, ?, ?)
2025-02-06 14:40:07,196 INFO sqlalchemy.engine.Engine [generated in 0.00024s] (1, '散货船', 'Bulk carrier', 'I001')
2025-02-06 14:40:07,197 INFO sqlalchemy.engine.Engine INSERT INTO time_zone (id, name_cn, name_en, explaination) VALUES (?, ?, ?, ?)
2025-02-06 14:40:07,197 INFO sqlalchemy.engine.Engine [generated in 0.00022s] (1, '中国标准时间', 'China Standard Time', 'UTC+8')
2025-02-06 14:40:07,199 INFO sqlalchemy.engine.Engine INSERT INTO vessel (id, name, mmsi, build_date, gross_tone, dead_weight, new_vessel, hull_clean_date, engine_overhaul_date, newly_paint_date, propeller_polish_date, created_at, company_id, ship_type_id, time_zone_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-02-06 14:40:07,200 INFO sqlalchemy.engine.Engine [generated in 0.00033s] (1, '船名', '1', '2024-12-06', 1.0, 2.0, 1, '2024-12-06', '2024-12-06', '2024-12-06', '2024-12-06', '2025-02-06 14:40:07.193175', 1, 1, 1)
2025-02-06 14:40:07,200 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("power_speed_curve")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE power_speed_curve (
	id INTEGER NOT NULL, 
	speed_water FLOAT NOT NULL, 
	me_power FLOAT NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00029s] (1, 'Company Test', None, None, None, None, '2025-02-06 14:40:07.192638')
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO ship_type (id, name_cn, name_en, code) VALUES (?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00024s] (1, '散货船', 'Bulk carrier', 'I001')
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO time_zone (id, name_cn, name_en, explaination) VALUES (?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00022s] (1, '中国标准时间', 'China Standard Time', 'UTC+8')
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO vessel (id, name, mmsi, build_date, gross_tone, dead_weight, new_vessel, hull_clean_date, engine_overhaul_date, newly_paint_date, propeller_polish_date, created_at, company_id, ship_type_id, time_zone_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00033s] (1, '船名', '1', '2024-12-06', 1.0, 2.0, 1, '2024-12-06', '2024-12-06', '2024-12-06', '2024-12-06', '2025-02-06 14:40:07.193175', 1, 1, 1)
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
----------------------------- Captured stdout call -----------------------------
2025-02-06 14:40:07,204 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:07,206 INFO sqlalchemy.engine.Engine SELECT vessel.id AS vessel_id, vessel.name AS vessel_name, vessel.mmsi AS vessel_mmsi, vessel.build_date AS vessel_build_date, vessel.gross_tone AS vessel_gross_tone, vessel.dead_weight AS vessel_dead_weight, vessel.new_vessel AS vessel_new_vessel, vessel.hull_clean_date AS vessel_hull_clean_date, vessel.engine_overhaul_date AS vessel_engine_overhaul_date, vessel.newly_paint_date AS vessel_newly_paint_date, vessel.propeller_polish_date AS vessel_propeller_polish_date, vessel.created_at AS vessel_created_at, vessel.company_id AS vessel_company_id, vessel.ship_type_id AS vessel_ship_type_id, vessel.time_zone_id AS vessel_time_zone_id 
FROM vessel 
WHERE vessel.id = ?
2025-02-06 14:40:07,206 INFO sqlalchemy.engine.Engine [generated in 0.00023s] (1,)
2025-02-06 14:40:07,208 INFO sqlalchemy.engine.Engine SELECT equipment.id AS equipment_id, equipment.name AS equipment_name, equipment.type AS equipment_type, equipment.created_at AS equipment_created_at, equipment.vessel_id AS equipment_vessel_id 
FROM equipment 
WHERE ? = equipment.vessel_id
2025-02-06 14:40:07,208 INFO sqlalchemy.engine.Engine [generated in 0.00021s] (1,)
2025-02-06 14:40:07,210 INFO sqlalchemy.engine.Engine DELETE FROM vessel WHERE vessel.id = ?
2025-02-06 14:40:07,210 INFO sqlalchemy.engine.Engine [generated in 0.00019s] (1,)
2025-02-06 14:40:07,210 INFO sqlalchemy.engine.Engine COMMIT
2025-02-06 14:40:07,215 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-02-06 14:40:07,215 INFO sqlalchemy.engine.Engine SELECT vessel.id AS vessel_id, vessel.name AS vessel_name, vessel.mmsi AS vessel_mmsi, vessel.build_date AS vessel_build_date, vessel.gross_tone AS vessel_gross_tone, vessel.dead_weight AS vessel_dead_weight, vessel.new_vessel AS vessel_new_vessel, vessel.hull_clean_date AS vessel_hull_clean_date, vessel.engine_overhaul_date AS vessel_engine_overhaul_date, vessel.newly_paint_date AS vessel_newly_paint_date, vessel.propeller_polish_date AS vessel_propeller_polish_date, vessel.created_at AS vessel_created_at, vessel.company_id AS vessel_company_id, vessel.ship_type_id AS vessel_ship_type_id, vessel.time_zone_id AS vessel_time_zone_id 
FROM vessel 
WHERE vessel.id = ?
2025-02-06 14:40:07,216 INFO sqlalchemy.engine.Engine [cached since 0.009797s ago] (1,)
------------------------------ Captured log call -------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT vessel.id AS vessel_id, vessel.name AS vessel_name, vessel.mmsi AS vessel_mmsi, vessel.build_date AS vessel_build_date, vessel.gross_tone AS vessel_gross_tone, vessel.dead_weight AS vessel_dead_weight, vessel.new_vessel AS vessel_new_vessel, vessel.hull_clean_date AS vessel_hull_clean_date, vessel.engine_overhaul_date AS vessel_engine_overhaul_date, vessel.newly_paint_date AS vessel_newly_paint_date, vessel.propeller_polish_date AS vessel_propeller_polish_date, vessel.created_at AS vessel_created_at, vessel.company_id AS vessel_company_id, vessel.ship_type_id AS vessel_ship_type_id, vessel.time_zone_id AS vessel_time_zone_id 
FROM vessel 
WHERE vessel.id = ?
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00023s] (1,)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT equipment.id AS equipment_id, equipment.name AS equipment_name, equipment.type AS equipment_type, equipment.created_at AS equipment_created_at, equipment.vessel_id AS equipment_vessel_id 
FROM equipment 
WHERE ? = equipment.vessel_id
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00021s] (1,)
INFO     sqlalchemy.engine.Engine:base.py:1846 DELETE FROM vessel WHERE vessel.id = ?
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00019s] (1,)
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT vessel.id AS vessel_id, vessel.name AS vessel_name, vessel.mmsi AS vessel_mmsi, vessel.build_date AS vessel_build_date, vessel.gross_tone AS vessel_gross_tone, vessel.dead_weight AS vessel_dead_weight, vessel.new_vessel AS vessel_new_vessel, vessel.hull_clean_date AS vessel_hull_clean_date, vessel.engine_overhaul_date AS vessel_engine_overhaul_date, vessel.newly_paint_date AS vessel_newly_paint_date, vessel.propeller_polish_date AS vessel_propeller_polish_date, vessel.created_at AS vessel_created_at, vessel.company_id AS vessel_company_id, vessel.ship_type_id AS vessel_ship_type_id, vessel.time_zone_id AS vessel_time_zone_id 
FROM vessel 
WHERE vessel.id = ?
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.009797s ago] (1,)
--------------------------- Captured stdout teardown ---------------------------
2025-02-06 14:40:07,802 INFO sqlalchemy.engine.Engine ROLLBACK
---------------------------- Captured log teardown -----------------------------
INFO     sqlalchemy.engine.Engine:base.py:2704 ROLLBACK
=============================== warnings summary ===============================
tests/test_company_crud.py: 5 warnings
tests/test_upload_cr.py: 7 warnings
tests/test_user_crud.py: 10 warnings
tests/test_vessel_crud.py: 10 warnings
  /home/runner/.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/pydantic/fields.py:568: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    return self.default_factory()

tests/test_vessel_crud.py::test_create_vessel
tests/test_vessel_crud.py::test_create_vessel
tests/test_vessel_crud.py::test_create_vessel
tests/test_vessel_crud.py::test_create_vessel
tests/test_vessel_crud.py::test_update_vessel
  /home/runner/.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/sqlmodel/_compat.py:320: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    cls.__pydantic_validator__.validate_python(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
----- generated xml file: /home/runner/work/data/data/fastapis/pytest.xml ------

---------- coverage: platform linux, python 3.13.1-final-0 -----------
Name                               Stmts   Miss  Cover   Missing
----------------------------------------------------------------
app/core/error.py                      9      2    78%   8, 13
app/core/mongo.py                     14      5    64%   12, 15, 18, 22-23
app/core/mysql.py                     17      6    65%   12, 17, 20, 23, 27-28
app/core/security.py                  64     38    41%   32, 36, 40-43, 51-86, 90-92, 97-99, 104-106
app/entity/company.py                 16      2    88%   7-8
app/entity/equipment.py               16      1    94%   11
app/entity/meta.py                    31      2    94%   8-9
app/entity/vessel.py                  27      1    96%   10
app/main.py                           79     34    57%   28-40, 43-51, 56-69, 79-81, 103, 114-115, 127-128, 140-141, 162-184
app/router/company.py                 28     10    64%   23-24, 35-36, 43-44, 51-52, 59-60
app/router/equipment.py               33     33     0%   1-75
app/router/power_speed_curve.py       29     10    66%   20-21, 29-30, 38-39, 48-49, 57-58
app/router/upload.py                  45      9    80%   72-75, 87-92
app/router/user.py                    53     27    49%   25, 31-32, 38-39, 47-48, 56-57, 63-64, 70-77, 85-103
app/service/company.py                51     34    33%   16, 21, 24-27, 30-33, 36-49, 52-57, 60-63
app/service/data.py                   14      5    64%   7, 12, 15, 19, 22
app/service/equipment.py              37     37     0%   1-47
app/service/power_speed_curve.py      37     24    35%   10, 15, 18-20, 23-26, 29-33, 36-41, 44-47
app/service/upload.py                 44     11    75%   28, 46-48, 52-68
app/service/user.py                   47     31    34%   12, 17, 20-22, 25-27, 30-33, 36-44, 47-52, 55-58
----------------------------------------------------------------
TOTAL                                979    322    67%

22 files skipped due to complete coverage.

=========================== short test summary info ============================
FAILED tests/test_company_crud.py::test_read_companies - KeyError: 'code'
FAILED tests/test_company_crud.py::test_read_company - KeyError: 'code'
FAILED tests/test_company_crud.py::test_read_company_not_found - KeyError: 'message'
FAILED tests/test_company_crud.py::test_create_company - KeyError: 'code'
FAILED tests/test_company_crud.py::test_create_company_duplicate - KeyError: 'code'
FAILED tests/test_company_crud.py::test_update_company - KeyError: 'code'
FAILED tests/test_company_crud.py::test_delete_company - KeyError: 'code'
FAILED tests/test_user_crud.py::test_read_users - KeyError: 'code'
FAILED tests/test_user_crud.py::test_read_user - KeyError: 'code'
FAILED tests/test_user_crud.py::test_read_user_not_found - AssertionError: assert 'Not Found' == '用户不存在'
  
  - 用户不存在
  + Not Found
FAILED tests/test_user_crud.py::test_create_user - KeyError: 'code'
FAILED tests/test_user_crud.py::test_update_user - KeyError: 'code'
FAILED tests/test_user_crud.py::test_delete_user - KeyError: 'code'
FAILED tests/test_vessel_crud.py::test_read_vessel_not_found - app.core.error.NotFoundException
FAILED tests/test_vessel_crud.py::test_delete_vessel - app.core.error.NotFoundException
================== 15 failed, 9 passed, 37 warnings in 2.41s ===================
