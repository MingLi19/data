============================= test session starts ==============================
platform linux -- Python 3.13.1, pytest-8.3.4, pluggy-1.5.0
rootdir: /home/runner/work/data/data/fastapis
configfile: pyproject.toml
plugins: cov-6.0.0, anyio-4.6.2.post1
collected 24 items

tests/test_company_crud.py .......                                       [ 29%]
tests/test_meta_r.py ...                                                 [ 41%]
tests/test_upload_cr.py ..                                               [ 50%]
tests/test_user_crud.py ......                                           [ 75%]
tests/test_vessel_crud.py ..F..F                                         [100%]

=================================== FAILURES ===================================
__________________________ test_read_vessel_not_found __________________________

client = <starlette.testclient.TestClient object at 0x7f47b17c1fd0>

    def test_read_vessel_not_found(client: TestClient):
        response = client.get("/vessel/2")
        assert response.status_code == 404
>       assert response.json()["detail"] == "船舶不存在"
E       KeyError: 'detail'

tests/test_vessel_crud.py:72: KeyError
---------------------------- Captured stdout setup -----------------------------
2025-01-15 12:18:48,538 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-01-15 12:18:48,538 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-01-15 12:18:48,538 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,538 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-01-15 12:18:48,538 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,539 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-01-15 12:18:48,539 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,539 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-01-15 12:18:48,539 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,539 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-01-15 12:18:48,539 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,540 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-01-15 12:18:48,540 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,540 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-01-15 12:18:48,540 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,540 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-01-15 12:18:48,541 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,541 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-01-15 12:18:48,541 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,541 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-01-15 12:18:48,541 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,541 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-01-15 12:18:48,542 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,542 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-01-15 12:18:48,542 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,542 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-01-15 12:18:48,542 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,542 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-01-15 12:18:48,543 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,543 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-01-15 12:18:48,543 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,543 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-01-15 12:18:48,543 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,544 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-01-15 12:18:48,544 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,544 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-01-15 12:18:48,544 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,545 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-01-15 12:18:48,545 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-01-15 12:18:48,545 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-01-15 12:18:48,545 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-01-15 12:18:48,546 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-01-15 12:18:48,546 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-01-15 12:18:48,547 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-01-15 12:18:48,547 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-01-15 12:18:48,547 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-01-15 12:18:48,548 INFO sqlalchemy.engine.Engine [no key 0.00015s] ()
2025-01-15 12:18:48,548 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-01-15 12:18:48,548 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-01-15 12:18:48,549 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-01-15 12:18:48,549 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-01-15 12:18:48,550 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-01-15 12:18:48,550 INFO sqlalchemy.engine.Engine [no key 0.00016s] ()
2025-01-15 12:18:48,550 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-01-15 12:18:48,550 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-01-15 12:18:48,550 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00015s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00016s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
----------------------------- Captured stdout call -----------------------------
2025-01-15 12:18:48,554 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-01-15 12:18:48,556 INFO sqlalchemy.engine.Engine SELECT vessel.id AS vessel_id, vessel.name AS vessel_name, vessel.mmsi AS vessel_mmsi, vessel.build_date AS vessel_build_date, vessel.gross_tone AS vessel_gross_tone, vessel.dead_weight AS vessel_dead_weight, vessel.new_vessel AS vessel_new_vessel, vessel.hull_clean_date AS vessel_hull_clean_date, vessel.engine_overhaul_date AS vessel_engine_overhaul_date, vessel.newly_paint_date AS vessel_newly_paint_date, vessel.propeller_polish_date AS vessel_propeller_polish_date, vessel.created_at AS vessel_created_at, vessel.company_id AS vessel_company_id, vessel.ship_type_id AS vessel_ship_type_id, vessel.time_zone_id AS vessel_time_zone_id 
FROM vessel 
WHERE vessel.id = ?
2025-01-15 12:18:48,556 INFO sqlalchemy.engine.Engine [generated in 0.00021s] (2,)
------------------------------ Captured log call -------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT vessel.id AS vessel_id, vessel.name AS vessel_name, vessel.mmsi AS vessel_mmsi, vessel.build_date AS vessel_build_date, vessel.gross_tone AS vessel_gross_tone, vessel.dead_weight AS vessel_dead_weight, vessel.new_vessel AS vessel_new_vessel, vessel.hull_clean_date AS vessel_hull_clean_date, vessel.engine_overhaul_date AS vessel_engine_overhaul_date, vessel.newly_paint_date AS vessel_newly_paint_date, vessel.propeller_polish_date AS vessel_propeller_polish_date, vessel.created_at AS vessel_created_at, vessel.company_id AS vessel_company_id, vessel.ship_type_id AS vessel_ship_type_id, vessel.time_zone_id AS vessel_time_zone_id 
FROM vessel 
WHERE vessel.id = ?
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00021s] (2,)
ERROR    app.main:main.py:31 Not-Found error: request=<starlette.requests.Request object at 0x7f47b17ba360>, exc=
--------------------------- Captured stdout teardown ---------------------------
2025-01-15 12:18:48,598 INFO sqlalchemy.engine.Engine ROLLBACK
---------------------------- Captured log teardown -----------------------------
INFO     sqlalchemy.engine.Engine:base.py:2704 ROLLBACK
______________________________ test_delete_vessel ______________________________

client = <starlette.testclient.TestClient object at 0x7f47b2a16890>
setup = None

    def test_delete_vessel(client: TestClient, setup):
        response = client.delete("/vessel/1").json()
        code = response["code"]
        message = response["message"]
        assert code == 200
        assert message == "船舶删除成功"
    
        not_found_response = client.get("/vessel/1")
        assert not_found_response.status_code == 404
>       assert not_found_response.json()["detail"] == "船舶不存在"
E       KeyError: 'detail'

tests/test_vessel_crud.py:170: KeyError
---------------------------- Captured stdout setup -----------------------------
2025-01-15 12:18:48,710 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-01-15 12:18:48,710 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("company")
2025-01-15 12:18:48,710 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,711 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("company")
2025-01-15 12:18:48,711 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,711 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment_fuel")
2025-01-15 12:18:48,711 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,711 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment_fuel")
2025-01-15 12:18:48,712 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,712 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("fuel_type")
2025-01-15 12:18:48,712 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,712 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("fuel_type")
2025-01-15 12:18:48,712 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,713 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("ship_type")
2025-01-15 12:18:48,713 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,713 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("ship_type")
2025-01-15 12:18:48,713 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,713 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("time_zone")
2025-01-15 12:18:48,713 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,714 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("time_zone")
2025-01-15 12:18:48,714 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,714 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel_data_upload")
2025-01-15 12:18:48,714 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,714 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel_data_upload")
2025-01-15 12:18:48,714 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,715 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("vessel")
2025-01-15 12:18:48,715 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,715 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("vessel")
2025-01-15 12:18:48,715 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,715 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("equipment")
2025-01-15 12:18:48,716 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,716 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("equipment")
2025-01-15 12:18:48,716 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,716 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("user")
2025-01-15 12:18:48,716 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,716 INFO sqlalchemy.engine.Engine PRAGMA temp.table_info("user")
2025-01-15 12:18:48,717 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-01-15 12:18:48,717 INFO sqlalchemy.engine.Engine 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


2025-01-15 12:18:48,717 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-01-15 12:18:48,718 INFO sqlalchemy.engine.Engine 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


2025-01-15 12:18:48,718 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-01-15 12:18:48,719 INFO sqlalchemy.engine.Engine 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-01-15 12:18:48,719 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-01-15 12:18:48,719 INFO sqlalchemy.engine.Engine 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


2025-01-15 12:18:48,719 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-01-15 12:18:48,720 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


2025-01-15 12:18:48,720 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-01-15 12:18:48,721 INFO sqlalchemy.engine.Engine 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


2025-01-15 12:18:48,721 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-01-15 12:18:48,722 INFO sqlalchemy.engine.Engine 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-01-15 12:18:48,722 INFO sqlalchemy.engine.Engine [no key 0.00014s] ()
2025-01-15 12:18:48,722 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


2025-01-15 12:18:48,722 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-01-15 12:18:48,723 INFO sqlalchemy.engine.Engine 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


2025-01-15 12:18:48,723 INFO sqlalchemy.engine.Engine [no key 0.00013s] ()
2025-01-15 12:18:48,723 INFO sqlalchemy.engine.Engine COMMIT
2025-01-15 12:18:48,725 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-01-15 12:18:48,726 INFO sqlalchemy.engine.Engine INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
2025-01-15 12:18:48,726 INFO sqlalchemy.engine.Engine [generated in 0.00026s] (1, 'Company Test', None, None, None, None, '2025-01-15 12:18:48.724252')
2025-01-15 12:18:48,727 INFO sqlalchemy.engine.Engine INSERT INTO ship_type (id, name_cn, name_en, code) VALUES (?, ?, ?, ?)
2025-01-15 12:18:48,728 INFO sqlalchemy.engine.Engine [generated in 0.00023s] (1, '散货船', 'Bulk carrier', 'I001')
2025-01-15 12:18:48,729 INFO sqlalchemy.engine.Engine INSERT INTO time_zone (id, name_cn, name_en, explaination) VALUES (?, ?, ?, ?)
2025-01-15 12:18:48,729 INFO sqlalchemy.engine.Engine [generated in 0.00024s] (1, '中国标准时间', 'China Standard Time', 'UTC+8')
2025-01-15 12:18:48,731 INFO sqlalchemy.engine.Engine INSERT INTO vessel (id, name, mmsi, build_date, gross_tone, dead_weight, new_vessel, hull_clean_date, engine_overhaul_date, newly_paint_date, propeller_polish_date, created_at, company_id, ship_type_id, time_zone_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-01-15 12:18:48,731 INFO sqlalchemy.engine.Engine [generated in 0.00037s] (1, '船名', '1', '2024-12-06', 1.0, 2.0, 1, '2024-12-06', '2024-12-06', '2024-12-06', '2024-12-06', '2025-01-15 12:18:48.724722', 1, 1, 1)
2025-01-15 12:18:48,731 INFO sqlalchemy.engine.Engine COMMIT
------------------------------ Captured log setup ------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("company")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment_fuel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("fuel_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("ship_type")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("time_zone")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel_data_upload")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("vessel")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("equipment")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA main.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 PRAGMA temp.table_info("user")
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	address VARCHAR, 
	contact_person VARCHAR, 
	contact_phone VARCHAR, 
	contact_email VARCHAR, 
	created_at DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE fuel_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	name_abbr VARCHAR NOT NULL, 
	cf FLOAT NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE ship_type (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	code VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE time_zone (
	id INTEGER NOT NULL, 
	name_cn VARCHAR NOT NULL, 
	name_en VARCHAR NOT NULL, 
	explaination VARCHAR NOT NULL, 
	PRIMARY KEY (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	mmsi VARCHAR NOT NULL, 
	build_date VARCHAR NOT NULL, 
	gross_tone FLOAT NOT NULL, 
	dead_weight FLOAT NOT NULL, 
	new_vessel BOOLEAN NOT NULL, 
	hull_clean_date VARCHAR, 
	engine_overhaul_date VARCHAR, 
	newly_paint_date VARCHAR, 
	propeller_polish_date VARCHAR, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	ship_type_id INTEGER, 
	time_zone_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	UNIQUE (mmsi), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	FOREIGN KEY(ship_type_id) REFERENCES ship_type (id), 
	FOREIGN KEY(time_zone_id) REFERENCES time_zone (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE user (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	username VARCHAR NOT NULL, 
	hashed_password VARCHAR NOT NULL, 
	phone VARCHAR NOT NULL, 
	is_admin BOOLEAN NOT NULL, 
	is_system_admin BOOLEAN NOT NULL, 
	disabled BOOLEAN NOT NULL, 
	created_at DATETIME NOT NULL, 
	company_id INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (username), 
	FOREIGN KEY(company_id) REFERENCES company (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE vessel_data_upload (
	id INTEGER NOT NULL, 
	file_path VARCHAR NOT NULL, 
	date_start DATETIME, 
	date_end DATETIME, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00014s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment (
	id INTEGER NOT NULL, 
	name VARCHAR NOT NULL, 
	type VARCHAR(3) NOT NULL, 
	created_at DATETIME NOT NULL, 
	vessel_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(vessel_id) REFERENCES vessel (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 
CREATE TABLE equipment_fuel (
	equipment_id INTEGER NOT NULL, 
	fuel_type_id INTEGER NOT NULL, 
	PRIMARY KEY (equipment_id, fuel_type_id), 
	FOREIGN KEY(equipment_id) REFERENCES equipment (id) ON DELETE CASCADE, 
	FOREIGN KEY(fuel_type_id) REFERENCES fuel_type (id)
)


INFO     sqlalchemy.engine.Engine:base.py:1846 [no key 0.00013s] ()
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO company (id, name, address, contact_person, contact_phone, contact_email, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00026s] (1, 'Company Test', None, None, None, None, '2025-01-15 12:18:48.724252')
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO ship_type (id, name_cn, name_en, code) VALUES (?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00023s] (1, '散货船', 'Bulk carrier', 'I001')
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO time_zone (id, name_cn, name_en, explaination) VALUES (?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00024s] (1, '中国标准时间', 'China Standard Time', 'UTC+8')
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO vessel (id, name, mmsi, build_date, gross_tone, dead_weight, new_vessel, hull_clean_date, engine_overhaul_date, newly_paint_date, propeller_polish_date, created_at, company_id, ship_type_id, time_zone_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00037s] (1, '船名', '1', '2024-12-06', 1.0, 2.0, 1, '2024-12-06', '2024-12-06', '2024-12-06', '2024-12-06', '2025-01-15 12:18:48.724722', 1, 1, 1)
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
----------------------------- Captured stdout call -----------------------------
2025-01-15 12:18:48,735 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-01-15 12:18:48,737 INFO sqlalchemy.engine.Engine SELECT vessel.id AS vessel_id, vessel.name AS vessel_name, vessel.mmsi AS vessel_mmsi, vessel.build_date AS vessel_build_date, vessel.gross_tone AS vessel_gross_tone, vessel.dead_weight AS vessel_dead_weight, vessel.new_vessel AS vessel_new_vessel, vessel.hull_clean_date AS vessel_hull_clean_date, vessel.engine_overhaul_date AS vessel_engine_overhaul_date, vessel.newly_paint_date AS vessel_newly_paint_date, vessel.propeller_polish_date AS vessel_propeller_polish_date, vessel.created_at AS vessel_created_at, vessel.company_id AS vessel_company_id, vessel.ship_type_id AS vessel_ship_type_id, vessel.time_zone_id AS vessel_time_zone_id 
FROM vessel 
WHERE vessel.id = ?
2025-01-15 12:18:48,737 INFO sqlalchemy.engine.Engine [generated in 0.00023s] (1,)
2025-01-15 12:18:48,738 INFO sqlalchemy.engine.Engine SELECT equipment.id AS equipment_id, equipment.name AS equipment_name, equipment.type AS equipment_type, equipment.created_at AS equipment_created_at, equipment.vessel_id AS equipment_vessel_id 
FROM equipment 
WHERE ? = equipment.vessel_id
2025-01-15 12:18:48,738 INFO sqlalchemy.engine.Engine [generated in 0.00020s] (1,)
2025-01-15 12:18:48,740 INFO sqlalchemy.engine.Engine DELETE FROM vessel WHERE vessel.id = ?
2025-01-15 12:18:48,740 INFO sqlalchemy.engine.Engine [generated in 0.00019s] (1,)
2025-01-15 12:18:48,740 INFO sqlalchemy.engine.Engine COMMIT
2025-01-15 12:18:48,744 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-01-15 12:18:48,744 INFO sqlalchemy.engine.Engine SELECT vessel.id AS vessel_id, vessel.name AS vessel_name, vessel.mmsi AS vessel_mmsi, vessel.build_date AS vessel_build_date, vessel.gross_tone AS vessel_gross_tone, vessel.dead_weight AS vessel_dead_weight, vessel.new_vessel AS vessel_new_vessel, vessel.hull_clean_date AS vessel_hull_clean_date, vessel.engine_overhaul_date AS vessel_engine_overhaul_date, vessel.newly_paint_date AS vessel_newly_paint_date, vessel.propeller_polish_date AS vessel_propeller_polish_date, vessel.created_at AS vessel_created_at, vessel.company_id AS vessel_company_id, vessel.ship_type_id AS vessel_ship_type_id, vessel.time_zone_id AS vessel_time_zone_id 
FROM vessel 
WHERE vessel.id = ?
2025-01-15 12:18:48,745 INFO sqlalchemy.engine.Engine [cached since 0.008061s ago] (1,)
------------------------------ Captured log call -------------------------------
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT vessel.id AS vessel_id, vessel.name AS vessel_name, vessel.mmsi AS vessel_mmsi, vessel.build_date AS vessel_build_date, vessel.gross_tone AS vessel_gross_tone, vessel.dead_weight AS vessel_dead_weight, vessel.new_vessel AS vessel_new_vessel, vessel.hull_clean_date AS vessel_hull_clean_date, vessel.engine_overhaul_date AS vessel_engine_overhaul_date, vessel.newly_paint_date AS vessel_newly_paint_date, vessel.propeller_polish_date AS vessel_propeller_polish_date, vessel.created_at AS vessel_created_at, vessel.company_id AS vessel_company_id, vessel.ship_type_id AS vessel_ship_type_id, vessel.time_zone_id AS vessel_time_zone_id 
FROM vessel 
WHERE vessel.id = ?
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00023s] (1,)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT equipment.id AS equipment_id, equipment.name AS equipment_name, equipment.type AS equipment_type, equipment.created_at AS equipment_created_at, equipment.vessel_id AS equipment_vessel_id 
FROM equipment 
WHERE ? = equipment.vessel_id
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00020s] (1,)
INFO     sqlalchemy.engine.Engine:base.py:1846 DELETE FROM vessel WHERE vessel.id = ?
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00019s] (1,)
INFO     sqlalchemy.engine.Engine:base.py:2707 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2701 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT vessel.id AS vessel_id, vessel.name AS vessel_name, vessel.mmsi AS vessel_mmsi, vessel.build_date AS vessel_build_date, vessel.gross_tone AS vessel_gross_tone, vessel.dead_weight AS vessel_dead_weight, vessel.new_vessel AS vessel_new_vessel, vessel.hull_clean_date AS vessel_hull_clean_date, vessel.engine_overhaul_date AS vessel_engine_overhaul_date, vessel.newly_paint_date AS vessel_newly_paint_date, vessel.propeller_polish_date AS vessel_propeller_polish_date, vessel.created_at AS vessel_created_at, vessel.company_id AS vessel_company_id, vessel.ship_type_id AS vessel_ship_type_id, vessel.time_zone_id AS vessel_time_zone_id 
FROM vessel 
WHERE vessel.id = ?
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.008061s ago] (1,)
ERROR    app.main:main.py:31 Not-Found error: request=<starlette.requests.Request object at 0x7f47b165cd60>, exc=
--------------------------- Captured stdout teardown ---------------------------
2025-01-15 12:18:48,752 INFO sqlalchemy.engine.Engine ROLLBACK
---------------------------- Captured log teardown -----------------------------
INFO     sqlalchemy.engine.Engine:base.py:2704 ROLLBACK
=============================== warnings summary ===============================
tests/test_company_crud.py: 5 warnings
tests/test_upload_cr.py: 7 warnings
tests/test_user_crud.py: 10 warnings
tests/test_vessel_crud.py: 10 warnings
  /home/runner/.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/pydantic/fields.py:568: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    return self.default_factory()

tests/test_company_crud.py::test_create_company
tests/test_company_crud.py::test_create_company_duplicate
tests/test_user_crud.py::test_create_user
tests/test_user_crud.py::test_update_user
tests/test_vessel_crud.py::test_create_vessel
tests/test_vessel_crud.py::test_create_vessel
tests/test_vessel_crud.py::test_create_vessel
tests/test_vessel_crud.py::test_create_vessel
tests/test_vessel_crud.py::test_update_vessel
  /home/runner/.cache/pypoetry/virtualenvs/non-package-mode-NjsN46fl-py3.13/lib/python3.13/site-packages/sqlmodel/_compat.py:320: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    cls.__pydantic_validator__.validate_python(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
----- generated xml file: /home/runner/work/data/data/fastapis/pytest.xml ------

---------- coverage: platform linux, python 3.13.1-final-0 -----------
Name                             Stmts   Miss  Cover   Missing
--------------------------------------------------------------
app/core/db.py                      10      3    70%   12, 16-17
app/core/error.py                    9      1    89%   13
app/entity/company.py               16      2    88%   7-8
app/entity/equipment.py             16      1    94%   11
app/entity/meta.py                  31      2    94%   8-9
app/entity/vessel.py                27      1    96%   10
app/main.py                         31      3    90%   20, 57-58
app/model/power_speed_curve.py      18     18     0%   1-32
app/router/equipment.py             33     33     0%   1-77
app/service/company.py              51      4    92%   45-48
app/service/equipment.py            37     37     0%   1-46
app/service/upload.py               30      1    97%   26
app/service/user.py                 43      1    98%   35
--------------------------------------------------------------
TOTAL                              700    107    85%

22 files skipped due to complete coverage.

=========================== short test summary info ============================
FAILED tests/test_vessel_crud.py::test_read_vessel_not_found - KeyError: 'detail'
FAILED tests/test_vessel_crud.py::test_delete_vessel - KeyError: 'detail'
================== 2 failed, 22 passed, 41 warnings in 1.21s ===================
